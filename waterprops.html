<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="content-language" content="zh-CN">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="水,水蒸汽,蒸汽,物性,热力学性质,在线计算,water, properties">
<title>水和蒸汽物性在线计算</title>
<link rel="stylesheet" href="style.css">
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
</head>
<body>
	<div class="wrap">
		<div id="sidebar"></div>
		<script>
			$(function(){
				$("#sidebar").load("sidebar.html");
			});
		</script>
		<div id="tab">
			<h2>水和蒸汽物性</h2>
			<form>
				<p><label>已知</label><select id="select" onchange="onSelected(this.options.selectedIndex)"></select></p>
				<div id="args"></div>
			</form>
			<p><button onclick="run()">计算</button></p>
			<h3>结果</h3>
			<textarea id="res"></textarea>
			<p>计算依据：<a href="http://www.iapws.org/relguide/IF97-Rev.pdf">http://www.iapws.org/relguide/IF97-Rev.pdf</a></p>
			<div class="footer"><p>微信公众号：jisuanhao</p></div>
		</div>
	</div>
	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "https://hm.baidu.com/hm.js?c601c0ade979f55c4e2d64e5eb0eac59";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
</body>
<script src="./js/xsteam.js"></script>
<script>
	var propObj = {
		T:   {name: "温度",         unit: "C",        },
		p:   {name: "压力",         unit: "MPaA",     },
		h:   {name: "比焓",         unit: "kJ/kg",    },
		v:   {name: "比体积",       unit: "m3/kg",    },
		rho: {name: "密度",         unit: "kg/m3",    },
		s:   {name: "比熵",         unit: "kJ/kg",    },
		u:   {name: "内能",         unit: "kJ/kg",    },
		Cp:  {name: "定压比热容",   unit: "kJ/(kg·K)",},
		Cv:  {name: "定容比热容",   unit: "kJ/(kg·K)",},
		w:   {name: "声速",         unit: "m/s",      },
		my:  {name: "动力粘度",     unit: "Pa·s",     },
		tc:  {name: "导热系数",     unit: "W/(m·K)",  },
		st:  {name: "表面张力",     unit: "N/m",      },
		x:   {name: "干度",         unit: "",         },
		vx:  {name: "气态体积分数", unit: "",         }
	}
	
	var modes = [
            ['p','T'],
			['p','h'],
            ['p','s'],
			['p','x'],
			['T','x'],
            ['h','s']
        ]
		
	var selectedIndex
	
	(function(){
		var select_ele = document.getElementById("select")
		modes.forEach((item, index) => {
			select_ele.options.add(new Option(propObj[item[0]].name + "-" + propObj[item[1]].name, index))
		})
		
		onSelected(0)
	}())
	
	function onSelected(index){
		let args_ele = document.getElementById("args")
		args_ele.innerHTML = ''
		selectedIndex = index
		modes[index].forEach(prop => {
				let input_ele = document.createElement("p")
				input_ele.innerHTML = '<label>' + propObj[prop].name + '</label><input name="' + prop +'"/> ' + propObj[prop].unit
				args_ele.appendChild(input_ele)
		})
	}
	
	function run(){
		let len = modes[selectedIndex].length, arg1, arg2, result = {}
		
		arg1 = parseFloat(document.getElementsByName(modes[selectedIndex][0])[0].value)
		arg2 = parseFloat(document.getElementsByName(modes[selectedIndex][len - 1])[0].value)
		
		if(modes[selectedIndex][0] == "T") arg1 += 273.15
		if(modes[selectedIndex][len - 1] == "T") arg2 += 273.15
		
		switch(selectedIndex) {
			case 0:
				result = pT(arg1, arg2)
				break;
			case 1:
				result = ph(arg1, arg2)
				break;
			case 2:
				result = ps(arg1, arg2)
				break;
			case 3:
				result = px(arg1, arg2)
				break;
			case 4:
				result = Tx(arg1, arg2)
				break;
			case 5:
				result = hs(arg1, arg2)
				break;
		}
		
		result.T -= 273.15
		
		let strResult = ''
		for (let prop in propObj){
			if(result.hasOwnProperty(prop)){
				let space = propObj[prop].name.length < 3 ? "：\t\t" : "：\t"

				strResult += propObj[prop].name + space + result[prop] + " " + propObj[prop].unit + "\n"
			}
		}
		strResult += "绝热指数：\t" + result.Cp / result.Cv
		document.getElementById("res").value = strResult.substr(0, strResult.length - 2)
	}
	
</script>
</html>